{"version":3,"sources":["../../../../dist-tsc/schemas/main/ENSName/index.js"],"names":["Object","defineProperty","exports","value","ethereumjs_util_1","require","Web3","types_1","namehash","name","node","labels","split","i","length","labelHash","sha3","toString","Buffer","nodehash","label","ENSNameSchema","version","deploymentBlock","description","thumbnail","website","fields","type","readOnly","unifyFields","Name","NodeHash","NameHash","assetFromFields","nodeHash","nameHash","checkAsset","asset","formatter","title","slice","url","properties","functions","transfer","AbiType","Function","payable","constant","stateMutability","StateMutability","Nonpayable","target","inputs","kind","FunctionInputKind","Asset","Replaceable","outputs","ownerOf","View","FunctionOutputKind","Owner","assetsOfOwnerByIndex","events","hash","a"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ethereumjs_util_1 = require(\"ethereumjs-util\");\nconst Web3 = require(\"web3\");\nconst types_1 = require(\"../../../types\");\nconst namehash = (name) => {\n    let node = '0000000000000000000000000000000000000000000000000000000000000000';\n    if (name !== '') {\n        const labels = name.split('.');\n        for (let i = labels.length - 1; i >= 0; i--) {\n            const labelHash = ethereumjs_util_1.sha3(labels[i]).toString('hex');\n            node = ethereumjs_util_1.sha3(new Buffer(node + labelHash, 'hex')).toString('hex');\n        }\n    }\n    return '0x' + node.toString();\n};\nconst nodehash = (name) => {\n    const label = name.split('.')[0];\n    if (label) {\n        return '0x' + ethereumjs_util_1.sha3(label).toString('hex');\n    }\n    else {\n        return '';\n    }\n};\nexports.ENSNameSchema = {\n    version: 2,\n    deploymentBlock: 3605331,\n    name: 'ENSName',\n    description: 'Ethereum Name Service Name (EIP 137)',\n    thumbnail: 'https://ens.domains/img/ens.svg',\n    website: 'https://github.com/ethereum/EIPs/blob/master/EIPS/eip-137.md',\n    fields: [\n        { name: 'Name', type: 'string', description: 'ENS Name' },\n        { name: 'NodeHash', type: 'bytes32', description: 'ENS Node Hash', readOnly: true },\n        { name: 'NameHash', type: 'bytes32', description: 'ENS Name Hash', readOnly: true },\n    ],\n    unifyFields: (fields) => ({\n        Name: fields.Name,\n        NodeHash: nodehash(fields.Name),\n        NameHash: namehash(fields.Name),\n    }),\n    assetFromFields: (fields) => ({\n        name: fields.Name,\n        nodeHash: fields.NodeHash,\n        nameHash: fields.NameHash,\n    }),\n    checkAsset: (asset) => {\n        return asset.name ? (namehash(asset.name) === asset.nameHash && nodehash(asset.name) === asset.nodeHash) : true;\n    },\n    formatter: async (asset) => {\n        return {\n            thumbnail: 'https://ens.domains/img/ens.svg',\n            title: 'ENS Name ' + (asset.name ? asset.name : asset.nodeHash.slice(0, 4) + '...'),\n            description: 'ENS node ' + asset.nodeHash,\n            url: 'https://etherscan.io/enslookup?q=' + asset.name,\n            properties: [],\n        };\n    },\n    functions: {\n        transfer: asset => ({\n            type: Web3.AbiType.Function,\n            name: 'transfer',\n            payable: false,\n            constant: false,\n            stateMutability: types_1.StateMutability.Nonpayable,\n            target: '0x6090a6e47849629b7245dfa1ca21d94cd15878ef',\n            inputs: [\n                { kind: types_1.FunctionInputKind.Asset, name: '_hash', type: 'bytes32', value: asset.nodeHash },\n                { kind: types_1.FunctionInputKind.Replaceable, name: 'newOwner', type: 'address' },\n            ],\n            outputs: [],\n        }),\n        ownerOf: asset => ({\n            type: Web3.AbiType.Function,\n            name: 'owner',\n            payable: false,\n            constant: true,\n            stateMutability: types_1.StateMutability.View,\n            target: '0x314159265dD8dbb310642f98f50C066173C1259b',\n            inputs: [\n                { kind: types_1.FunctionInputKind.Asset, name: 'node', type: 'bytes32', value: asset.nameHash },\n            ],\n            outputs: [\n                { kind: types_1.FunctionOutputKind.Owner, name: '', type: 'address' },\n            ],\n        }),\n        assetsOfOwnerByIndex: [],\n    },\n    events: {\n        transfer: [],\n    },\n    hash: a => a.nodeHash,\n};\n//# sourceMappingURL=index.js.map"]}